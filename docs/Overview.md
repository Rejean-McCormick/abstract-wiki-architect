

# üèõÔ∏è Abstract Wiki Architect: System Documentation

### **1. üß† Data Centralization (The Source of Truth)**

These files hold the configuration, paths, and definitions. They are the "Brain" of the system. If you want to add a language or change a setting, you edit these.

| File Path | Role | Description |
| :--- | :--- | :--- |
| **`rgl_paths.json`** | **Ground Truth** | Generated by `generate_path_map.py`. It maps every available RGL language module on your disk to its specific file path. **`builder/config.py`** reads this to know which languages exist. |
| **`builder/config.py`** | **The Blueprint** | The central configuration script. It loads `rgl_paths.json`, defines the **Ambiguity Strategy** (e.g., `indef`), handles ISO-to-RGL code mapping (e.g., `Deu` -\> `Ger`), and defines shared RGL families. |
| **`language_profiles/profiles.json`** | **Frontend Config** | Holds metadata for the API/Frontend (e.g., "French belongs to the Romance family"). This file is updated automatically by `sync_config_from_gf.py` after a build. |
| **`data/lexicon/`** | **Lexical Data** | A directory containing JSON shards (e.g., `people.json`, `science.json`) generated from Wikidata. This is the raw vocabulary that `forge.py` will eventually read to build the lexicon. |

-----

### **2. üèóÔ∏è The Builder Core (Construction)**

These files are responsible for taking the "Truth" and converting it into a working Grammar Binary (`.pgf`).

| File Path | Role | Description |
| :--- | :--- | :--- |
| **`build_orchestrator.py`** | **The Boss** | The entry point. You run this script. It coordinates the entire workflow: it calls `forge.py` to write code, then `compiler.py` to build it. |
| **`builder/forge.py`** | **The Factory** | The code generator. It reads `config.py` and `rgl_paths.json`, deletes old/broken `.gf` files, and writes new ones using your chosen architectural strategies (e.g., enforcing `mkNP a_Det cn`). |
| **`builder/compiler.py`** | **The Worker** | The interface to the GF binary. It constructs the complex path arguments (handling WSL/Windows paths), runs the `gf -make` commands, and links the final `Wiki.pgf`. |
| **`builder/__init__.py`** | **Package Marker** | An empty file that tells Python to treat the `builder` folder as a module, allowing imports like `from builder import forge`. |

-----

### **3. üî¨ Analysis & Verification (Quality Control)**

These files run *after* the build to ensure the system is working correctly and to synchronize the new grammar with the rest of the application.

| File Path | Role | Description |
| :--- | :--- | :--- |
| **`test_gf_dynamic.py`** | **Grammar Test** | Dynamically loads the new `Wiki.pgf`, detects all 50+ languages, and attempts to linearize a test sentence (e.g., "A cat"). It flags any language that fails to produce text. |
| **`check_all_languages.py`** | **API Test** | Tests the running Python API server. It sends a request for every supported language to ensure the web server is correctly loading the new grammar. |
| **`sync_config_from_gf.py`** | **The Bridge** | Extracts linguistic data (like Copulas) from the compiled `Wiki.pgf` and updates the JSON files in `data/` and `language_profiles/`, ensuring the frontend matches the backend. |
| **`audit_languages.py`** | **Deep Audit** | (Optional/Debug) Runs a slow, individual compilation of every language to isolate specific errors if the main build crashes. |

-----

### **4. üõ†Ô∏è Utilities & Helpers**

Standalone tools for specific tasks.

| File Path | Role | Description |
| :--- | :--- | :--- |
| **`generate_path_map.py`** | **Setup Tool** | Scans your `gf-rgl` directory and generates the `rgl_paths.json` file. You only run this once (or when you install new RGL languages). |
| **`build_lexicon_from_wikidata.py`** | **Data Miner** | Connects to Wikidata to fetch thousands of words (Scientists, Planets, etc.) and saves them to `data/lexicon/`. This feeds the system with new vocabulary. |
| **`cleanup_root.py`** | **Janitor** | Moves loose `.gf` files into `gf/` and deletes `.gfo` compiler artifacts to keep the root directory clean. |

-----

### **üìÇ System Directory Map**


root/
‚îú‚îÄ‚îÄ build_orchestrator.py        <-- [RUN THIS] to build everything
‚îú‚îÄ‚îÄ build_pipeline.bat           <-- [OR THIS] Batch wrapper for the pipeline
‚îú‚îÄ‚îÄ rgl_paths.json               <-- [DATA] The map of installed languages
‚îÇ
‚îú‚îÄ‚îÄ builder/                     <-- [MODULE] The Build System
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py                <-- [CONFIG] Central settings & logic
‚îÇ   ‚îú‚îÄ‚îÄ forge.py                 <-- [LOGIC] Code generator
‚îÇ   ‚îî‚îÄ‚îÄ compiler.py              <-- [LOGIC] GF Compiler interface
‚îÇ
‚îú‚îÄ‚îÄ gf/                          <-- [OUTPUT] Where .gf and .pgf files live
‚îÇ   ‚îú‚îÄ‚îÄ Wiki.pgf                 <-- The final compiled product
‚îÇ   ‚îî‚îÄ‚îÄ (Generated .gf files)
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ lexicon/                 <-- [DATA] Raw words from Wikidata
‚îÇ
‚îî‚îÄ‚îÄ utils/                       <-- (Suggested) Place for audit/cleanup scripts
    ‚îú‚îÄ‚îÄ test_gf_dynamic.py
    ‚îî‚îÄ‚îÄ check_all_languages.py
```

### **üöÄ How to Run the Pipeline**

**1. One-Click Build:**
Run `build_pipeline.bat` (Windows) or:

```
python build_orchestrator.py
```

**2. Update Lexicon (When adding words):**

```
python build_lexicon_from_wikidata.py
python build_orchestrator.py
```

**3. Verify System:**

```
python test_gf_dynamic.py
```